from flask import Flask
import sqlite3

# Функція, яка виконується при зверненні до кореневого URL ("/").
def index():
    # Встановлюємо з'єднання з базою даних SQLite під назвою "Artistc.db".
    conn = sqlite3.connect("Artistc.db")
    cursor = conn.cursor()  # Створюємо об'єкт курсора для виконання SQL-запитів.

    # Виконуємо SQL-запит, який отримує імена художників, народжених у зазначений рік.
    cursor.execute('SELECT name FROM artists WHERE "Birth Year" = (?)', [year])
    data = cursor.fetchall()  # Отримуємо всі результати запиту як список.

    # Якщо результатів немає, повертаємо повідомлення про відсутність даних для заданого року.
    if len(data) == 0:
        return 'no data about ' + str(year) + ' year'
    
    # Якщо є лише один запис, повертаємо інформацію про художника.
    elif len(data) == 1:
        return 'У ' + str(year) + ' році народився ' + data[0][0]
    
    # Якщо є кілька записів, створюємо HTML-список художників.
    else:
        result = '<h3>Список художників, які народилися в ' + str(year) + ' році:</h3><ol>'
        for person in data:  # Для кожного художника додаємо пункт списку.
            result += '<li>' + person[0] + '</li>'
        result += '</ol>'
        print(result)  # Виводимо результат у консоль (можливо, для налагодження).
    return result  # Повертаємо згенерований HTML-код як відповідь.

# Створюємо об'єкт веб-додатка Flask.
app = Flask(__name__)

# Додаємо URL-правило: кореневий URL ("/") буде оброблятися функцією `index`.
app.add_url_rule('/', 'index', index)

# Запитуємо у користувача рік, який він хоче перевірити.
year = int(input('Введіть рік народження художника: '))

# Перевіряємо, чи файл запускається як основний (а не імпортований як модуль).
if __name__ == "__main__":
    # Запускаємо веб-сервер на локальному хості (localhost) за замовчуванням.
    app.run()